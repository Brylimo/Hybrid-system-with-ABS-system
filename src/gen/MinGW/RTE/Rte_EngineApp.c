/** @file     Rte_EngineApp.c
  *
  * @brief    RTE Sample SWC implementation skeleton file
  *
  * @note     AUTOMATICALLY GENERATED FILE! DO NOT EDIT!
  *
  * @note     Generated by ETAS GmbH  RTA-RTE v5.10.0  (R4.0 backend version: v7.10.4 (Build 52732))
  */

#include "Rte_EngineApp.h"

/* --------------------------------------------------------------------------- */
/* RTE Event: /Engine_Composition/EngineApp/IB_EngineApp/TimingEvent_0 */

FUNC(void, EngineApp_CODE) RE_EngineApp_func(void)
{
	float32 pressure = Rte_DRead_Cylinder_Rport_pressure();
	float32 temperature = Rte_DRead_Cylinder_Rport_temperature();

	int target_power = Rte_DRead_Power_Rport_powerValue(); //실제코드
	//target_power = gettempInput(); //디버그용
	status_printf("target power :%d\r\n",target_power);

	sint8 cycleData[5] = {0, 0, 0, 0, 0};
	/*cycleData 	index 0 on off value
					index 1 pressure
					index 2 temperature
					index 3 target power rate (absolute value)
					index 4 spare space
	*/
	cycleData[1] = (sint8)pressure;
	cycleData[2] = (sint8) (temperature /10);

	if (target_power ==0){ //목표출력 0
	  cycleData[0] = 0; //off
	}
	else if (target_power <0){ //목표출력 음수
	  cycleData[0] = 1; //on
	  cycleData[3] = -target_power;
	  Rte_Trigger_PhyGear_Pport_level1();
	}
	else if (target_power <=40){ //목표출력 낮음
	  cycleData[0] = 1;
	  Rte_Trigger_PhyGear_Pport_level2(); //slow gear
	  cycleData[3] = target_power;
	}
	else{ //목표출력 높음
	  cycleData[0] = 1;
	  Rte_Trigger_PhyGear_Pport_level3(); //fast gear
	  cycleData[3] = target_power;
	}


	Rte_Write_CycleData_Pport_infoArray( cycleData );



}

